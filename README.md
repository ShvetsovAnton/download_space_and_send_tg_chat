# Скачиваем изображение космоса и отправляем их в телеграм

![imageup.ru](https://api.nasa.gov/EPIC/archive/natural/2019/05/30/png/epic_1b_20190530011359.png?api_key=DEMO_KEY)
## О проекте: 

Содержит пять скриптов

1. `main.py` - качает изображения, используя API с двух ресурсов https://api.nasa.gov/ и https://github.com/r-spacex/SpaceX-API
  * после скачивания изображений скрипт отправит их в телеграм канал и создаст папку `Image` в директории со скриптом.
  * отправка сообщений в телеграм будет происходить бесконечно, пока скрипт активен. После того как робот отправит фотографии в первый раз, он начнёт отправлять файлы в случайном порядке.
     * можно задать задержку между отправкой изображений.

2. `epic_image_download.py` качает изображение через API - https://api.nasa.gov/ 
[![imageup.ru](https://imageup.ru/img66/3990243/chrome_vk1pf4jils.png)](https://imageup.ru/img66/3990243/chrome_vk1pf4jils.png.html)
    * качает фотографии с архива Nasa, которые были сделаны телескопом "EPIC";
    * создаёт в директории проекта паку `Nasa_EPIC`.

3. `nasa_image_download.py`  качает изображение через API - https://api.nasa.gov/
[![imageup.ru](https://imageup.ru/img169/3990246/chrome_bctr4faxhc.png)](https://imageup.ru/img169/3990246/chrome_bctr4faxhc.png.html)
   * качает случайные фотографии с архива Nasa;
   * создаёт в директории проекта паку `Nasa_apod`.
    
4. `spacex_image_download.py` использует API лежащую в открытом доступе на github - https://github.com/r-spacex/SpaceX-API
    * имеет две вариации работы:
      * качает фотографии последнего запуска;
      * качает фотографии по заданному ID полёта.
    * создаёт в директории проекта паку `Spacex_launch`.

5. `send_file_in_telegram.py` отправляет файл в телеграм канал.
    * может отправить все файлы из папки;
    * может отправить один файл из директории, где лежит проект.

## Как подготовить проект к запуску

1. Создайте файл  `.env`  в директории проекта рядом с  `main.py` .
2. В файл  `.env`  добавьте строки со значениями:
   - `TELEGRAM_BOT_KEY="Ваш API ключ"`
   - `TELEGRAM_CHAT_ID="@ID вашего канала"`
   - `NASA_API_KEY="Ваш API ключ"`

#### Как получить API ключи и создать канал в телграме:

`TELEGRAM_BOT_KEY` можно получить при создании бота в телеграм, как это сделать - https://botcreators.ru/blog/botfather-instrukciya/
[![imageup.ru](https://imageup.ru/img120/3990253/telegram_trpah8babz.jpg)](https://imageup.ru/img120/3990253/telegram_trpah8babz.jpg.html)

`TELEGRAM_CHAT_ID` как создать канал - https://www.easydoit.ru/telegram/kak-dobavit-bota-v-kanal-telegram/

`NASA_API_KEY` что бы получить API nasa надо перейти на сайт - https://api.nasa.gov/ и заполнить форму "Generate API Key"
[![imageup.ru](https://imageup.ru/img154/3993663/chrome_327t9ltrsk.png)](https://imageup.ru/img154/3993663/chrome_327t9ltrsk.png.html)


__Важное!__ Телеграм бот должен быть админом в вашем канале.

## Подробнее о скриптах и как их запустить

### Запуск `main.py`

Скрипт `main.py`:
1. Создаёт папку, название которой необходимо указать, в противном случаи, все изображения загрузятся, в папку `"Image"`, в директорию со скриптом.
2. Отправляет скаченные изображения в Телеграм канал.
3. Можно регулировать задержку между отправкой файлов, по дефолку между отправкой сообщения - 14400 секунд (4 часа).
Аргументы для запуска скрипта:
* `--folder_name` - название папки в которую буду загружаться файлы. По умолчанию это папка `"Image"`.
* `--delay_before_send` - время отправки изображений в Телеграм канал, указывается в секундах, по дефолту, отправка будет осуществлять раз 14400 секунд(4 часа).
* `nasa_token` - токен который вы получили на странице - https://api.nasa.gov/

Перед запуском скрипта:
1. Убедитесь что телеграм бот создан и добавлен в группу.
2. Токен который получили при создании бота указаны в `.env` 
3. ID канала тоже есть в `.env`
4. API ключ, который Вы получили на сайте Nasa, тоже есть в файле `.env` 

Пример запуска:
```python
python main.py "NASA_API_KEY" --folder_name "Image" --delay_before_send 10
```


### Запуск `epic_image_download.py`

Скрипт `epic_image_download.py` качает изображение в папку `"Nasa_EPIC"`.

Ожидает один аргумент:
* `token_nasa` - получить свой токен можно на сайте - https://api.nasa.gov/, для тестов и простоты использования в скрипте задан токен.


  Пример запуска:

```python
python epic_image_download.py "Ваш API ключ"
```

Загружает изображение в папку `Nasa_EPIC`, которая будет находиться в дириктории проекта.

### Запуск `nasa_image_download.py` 
Скрипт ожидает один аргумент:

* `token_nasa` - получить токен можно на сайте - https://api.nasa.gov/


Загружает изображение в папку `Nasa_apod`, которая будет находиться в директории проекта.

Пример запуска:

```python
python nasa_image_download.py "Ваш API ключ"
```

### Запуск `spacex_image_download.py` 
Скрипт ожидает один аргумент:

* `--params` - id запуска, если он не указан скачает фото с последнего запуска.
* 
* Для можете использовать следующий id - `"5eb87d47ffd86e000604b38a"`.
  
Скачивает фотографии с последнего запуска или по заданному ID в папку `Spacex_launch`, которая будет находиться в директории проекта.

Пример запуска:
1. Скачать фото по ID запуска
```python
  python spacex_image_download.py --params "5eb87d47ffd86e000604b38a"
```
2. Скачать фотографии последнего запуска
```python
  python spacex_image_download.py
```

### Запуск `send_file_in_telegram.py`

Перед запуском скрипта:
1. Убедитесь что телеграм бот создан и добавлен в группу.
2. Токен который получили при создании бота и ID канала указаны в `.env`
Скрипт отправляет один файл или все файлы из папки в телеграм канал.

Аргументы для запуска скрипта:
* `--folder_name` - указываем название папки из которой будут отправлены файлы.
* `--file_name` - имя файла, которого необходимо отправить. ука
* `--delay_before_send` - время, указывается в секундах, отправки изображений в Телеграм чат, по дефолту, отправка будет осуществлять раз в 14400 сек(4 часа)



Cкрипт работает по двум сценариям:
1. Отправка одного изображения, из директорий в которой лежит скрипт

   * Для отправки файла, необходимо полностью указать его имя и расширение, пример - `Nasa_apod0.jpg`

Пример запуска:
```python
python send_file_in_telegram.py --file_name "Nasa_apod0.jpg"
```

2. Отправка всех изображений из указанной папки, папка должна находиться в директории проекта.

Пример запуска:
```python
python send_file_in_telegram.py --folder_name "Название папки" --delay_before_send 10
```
Если аргументы не будут заданы скрипт закончит работу после запуска.

## Требования к окружению

Python3 должен быть уже установлен.
Затем используйте  pip  (или  pip3 , есть конфликт с Python2) для установки зависимостей:

```python
pip install -r requirements.txt
```



